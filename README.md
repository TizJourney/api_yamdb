# api_yamdb
Проект имитирует api для работы с социальной сетью
## Функциональность
* Создание и авторизация пользователя с получением кода подтверждения через почту;
* Просмотр и редактирование профилей пользователей;
* Создание, просмотр, редактирование публикаций;
* Создание, просмотр, редактирование отзывов к публикациям;
* Выставление и подсчёт рейтинга для публикаций;
* Система администрирования и модерирования публикаций;
* Система поиска произведений по различным полям;

## Установка

### Виртуальное окружение
* Ставим виртуальное окружение: `python -m venv venv`
* Запускаем виртуальное окружение: (windows) `source venv/Scripts/activate` или (mac/linux) `source venv/bin/activate`

### Сборка окружения
* Продакшен сборка:  `pip install -r requirements.txt`
* Для разработки рекомендутеся dev-сборка: `pip install -r requirements_dev.txt`

### Настройка базы данных
* Если не используется заранее сохранённая база, то требуется инициализировать пустую базу: `python manage.py migrate` 

### Запуск
* Запуск локального сервера `python manage.py runserver`

### Заведение супер пользователя
* Далее нужно завести супер-пользователя `python manage.py createsuperuser`
* Супер-пользователь может создавать контент для базы данных через панель админа: `<адрес виртуального сервера>/admin`

### Залить данные из текстовых файлов в базу данных
* Из корневой директории запустить: `/script/csw_sqlite3.py`

## Работа с авторизацией
* В проекте используется [Signature JWT](https://jwt.io/introduction/)
* Авторзация работает через e-mail в 3 шага:
1. сначала делаете `POST` запрос на `/api/v1/auth/mail/` с полем `email`:
```
curl --location --request POST 'http://127.0.0.1:8000/api/v1/auth/mail/' \
--form 'email=example@email.com'
```
2. Оно создает в папке sent_emails файл, который будет содержать код активации 
3. Делаете `POST` запрос на `/api/v1/auth/token/` с полями `email` и `confirmation_code` и в ответ получаете токен
```
curl --location --request POST 'http://127.0.0.1:8000/api/v1/auth/token/' \
--form 'email=example@email.com' \
--form 'confirmation_code=5l5-1095457590921979885c'
```
* email и прочую релеватную информацию в отсуствие доступа до api можно посмотреть в админке: 'http://127.0.0.1:8000/admin'

## Работа с API
### Документация 
* Документацию для api можно найти по адресу: `<адрес виртуального сервера>\redoc`
